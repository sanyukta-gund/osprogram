/*
Write a program to implement an address book with options given below: a) Create address
book. b) View address book. c) Insert a record. d) Delete a record. e) Modify a record. f) Exit
*/

/* run kasa karycha
touch address_book.sh
nano address_book.sh
ctrl +o 
ctrl+x
./address_book
chmod +x addressbook.sh
./address_book
 */



#!/bin/bash

ADDRESS_BOOK="address_book.txt"

create_address_book() {
    if [ -f "$ADDRESS_BOOK" ]; then
        echo "Address book already exists."
    else
        touch "$ADDRESS_BOOK"
        echo "Address book created successfully."
    fi
}

view_address_book() {
    if [ ! -f "$ADDRESS_BOOK" ]; then
        echo "No address book found. Please create one first."
        return
    fi
    if [ ! -s "$ADDRESS_BOOK" ]; then
        echo "Address book is empty."
        return
    fi
    echo "Address Book Records:"
    nl -w2 -s'. ' "$ADDRESS_BOOK"
}

insert_record() {
    if [ ! -f "$ADDRESS_BOOK" ]; then
        echo "No address book found. Please create one first."
        return
    fi
    read -p "Enter name: " name
    read -p "Enter phone number: " phone
    read -p "Enter email: " email
    echo "$name,$phone,$email" >> "$ADDRESS_BOOK"
    echo "Record added successfully."
}

delete_record() {
    if [ ! -f "$ADDRESS_BOOK" ]; then
        echo "No address book found. Please create one first."
        return
    fi
    view_address_book
    read -p "Enter the record number to delete: " record_no
    total=$(wc -l < "$ADDRESS_BOOK")
    if [ "$record_no" -ge 1 ] && [ "$record_no" -le "$total" ]; then
        sed -i "${record_no}d" "$ADDRESS_BOOK"
        echo "Record deleted successfully."
    else
        echo "Invalid record number."
    fi
}

modify_record() {
    if [ ! -f "$ADDRESS_BOOK" ]; then
        echo "No address book found. Please create one first."
        return
    fi
    view_address_book
    read -p "Enter the record number to modify: " record_no
    total=$(wc -l < "$ADDRESS_BOOK")
    if [ "$record_no" -ge 1 ] && [ "$record_no" -le "$total" ]; then
        read -p "Enter new name: " name
        read -p "Enter new phone number: " phone
        read -p "Enter new email: " email
        sed -i "${record_no}s/.*/$name,$phone,$email/" "$ADDRESS_BOOK"
        echo "Record modified successfully."
    else
        echo "Invalid record number."
    fi
}

while true; do
    echo ""
    echo "Address Book Menu"
    echo "a) Create address book"
    echo "b) View address book"
    echo "c) Insert a record"
    echo "d) Delete a record"
    echo "e) Modify a record"
    echo "f) Exit"
    read -p "Enter your choice: " choice
    case $choice in
        a) create_address_book ;;
        b) view_address_book ;;
        c) insert_record ;;
        d) delete_record ;;
        e) modify_record ;;
        f) echo "Exiting..."; exit 0 ;;
        *) echo "Invalid choice. Please try again." ;;
    esac
done
